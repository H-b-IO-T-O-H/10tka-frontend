{"ast":null,"code":"import { Week } from \"@config/config\";\nimport { v4 as uuid } from \"uuid\";\nimport { makeDelete, makePost } from \"@utils/network\";\nimport { Urls } from \"@config/urls\";\nexport const Labels = {\n  'sem': 0,\n  'lek': 1,\n  'lr': 2,\n  'dz': 3,\n  'rk': 4,\n  'cons': 5,\n  'exam': 6,\n  'free': 7\n};\nconst LabelsInt = {\n  0: 'sem',\n  1: 'lek',\n  2: 'lr',\n  3: 'dz',\n  4: 'rk',\n  5: 'cons',\n  6: 'exam',\n  7: 'free'\n};\nexport const findNextDay = Lists => {\n  let idx = 0;\n  const isFull = !Week.some(item => {\n    if (!Lists[item.id]) {\n      idx = item.id;\n      return true;\n    }\n\n    return false;\n  });\n  return isFull ? -1 : idx;\n};\nexport const reorder = (list, startIndex, endIndex) => {\n  const result = Array.from(list);\n  const [removed] = result.splice(startIndex, 1);\n  result.splice(endIndex, 0, removed);\n  return result;\n};\nexport const copy = (item, destination, droppableIndex) => {\n  const destClone = Array.from(destination);\n  destClone.splice(droppableIndex, 0, { ...item,\n    id: uuid()\n  });\n  return destClone;\n};\nexport const checkFill = (header_text, footer_text) => {\n  return (header_text === null || header_text === void 0 ? void 0 : header_text.length) >= 2 && (footer_text === null || footer_text === void 0 ? void 0 : footer_text.length) >= 2;\n};\nexport const getDayDataFromList = day => {\n  return day.map((lesson, index) => ({\n    lesson_order: index + 1,\n    lesson_id: lesson.id,\n    title: lesson.props.header,\n    auditorium: lesson.props.footer,\n    lesson_type: LabelsInt[lesson.props.sourceIdx]\n  }));\n};\n\nconst changeWeekType = week_type => {\n  return week_type === \"Чc\" ? \"numerator\" : \"denominator\";\n};\n\nconst postWeekData = (week, showLabel) => {\n  makePost(Urls.timetable.post(), week).then(resp => {\n    console.log(resp);\n\n    if (resp.status !== 201) {\n      showLabel({\n        content: \"Не удалось сохранить изменения!\",\n        success: false\n      });\n    } else {\n      showLabel({\n        content: \"Успех!\",\n        success: true\n      });\n    }\n  }).catch(() => {\n    showLabel({\n      content: \"Не удалось сохранить изменения!\",\n      success: false\n    });\n  });\n};\n\nexport const saveTimetable = (Lists, deleted, panelData, showLabel) => {\n  const week = {\n    group: `IU10-${panelData.semester}${panelData.group}`,\n    week_type: changeWeekType(panelData.weekType),\n    week_number: panelData.weekType === \"Чс\" ? 1 : 2,\n    days: []\n  };\n  const idx = Object.keys(Lists);\n  idx.forEach(i => {\n    week.days.push({\n      day_order: parseInt(i) + 1,\n      lessons: getDayDataFromList(Lists[i])\n    });\n  });\n  showLabel({\n    content: \"\",\n    success: false\n  });\n  console.log(week);\n  makeDelete(Urls.timetable.delete(), {\n    lessons_ids: deleted.lessons\n  }).then(response => {\n    if (response.status === 200) {\n      postWeekData(week, showLabel);\n    } else {\n      showLabel({\n        content: \"Ошибка при удалении записей!\",\n        success: false\n      });\n    }\n  }).catch(err => {\n    if (err.response && err.response.status === 403) {\n      showLabel({\n        content: \"Недостаточно прав для изменения!\",\n        success: false\n      });\n    } else {\n      showLabel({\n        content: \"Ошибка при удалении записей!\",\n        success: false\n      });\n    }\n  });\n};","map":{"version":3,"sources":["/home/vlad/10tka/10tka-frontend/src/components/DragAndDrop/config.ts"],"names":["Week","v4","uuid","makeDelete","makePost","Urls","Labels","LabelsInt","findNextDay","Lists","idx","isFull","some","item","id","reorder","list","startIndex","endIndex","result","Array","from","removed","splice","copy","destination","droppableIndex","destClone","checkFill","header_text","footer_text","length","getDayDataFromList","day","map","lesson","index","lesson_order","lesson_id","title","props","header","auditorium","footer","lesson_type","sourceIdx","changeWeekType","week_type","postWeekData","week","showLabel","timetable","post","then","resp","console","log","status","content","success","catch","saveTimetable","deleted","panelData","group","semester","weekType","week_number","days","Object","keys","forEach","i","push","day_order","parseInt","lessons","delete","lessons_ids","response","err"],"mappings":"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","sourcesContent":["import {Week} from \"@config/config\";\nimport {v4 as uuid} from \"uuid\";\nimport {makeDelete, makePost} from \"@utils/network\";\nimport {Urls} from \"@config/urls\";\n\nexport const Labels = {'sem': 0, 'lek': 1, 'lr': 2, 'dz': 3, 'rk': 4, 'cons': 5, 'exam': 6, 'free': 7}\nconst LabelsInt = {0: 'sem', 1: 'lek', 2: 'lr', 3: 'dz', 4: 'rk', 5: 'cons', 6: 'exam', 7: 'free'}\n\n\nexport const findNextDay = (Lists: object) => {\n    let idx = 0;\n    const isFull = !Week.some((item) => {\n        if (!Lists[item.id]) {\n            idx = item.id;\n            return true;\n        }\n        return false;\n    })\n    return isFull ? -1 : idx;\n}\n\nexport const reorder = (list: Array<object>, startIndex: number, endIndex: number) => {\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n\n    return result;\n};\n\nexport const copy = (item: object, destination: Array<object>, droppableIndex: number) => {\n    const destClone = Array.from(destination);\n    destClone.splice(droppableIndex, 0, {...item, id: uuid()});\n\n    return destClone;\n};\n\nexport const checkFill = (header_text: string, footer_text: string): boolean => {\n    return header_text?.length >= 2 && footer_text?.length >= 2\n}\n\nexport const getDayDataFromList = (day: Array<{ id: string, props: any }>) => {\n    return day.map((lesson, index) => ({\n        lesson_order: index + 1,\n        lesson_id: lesson.id,\n        title: lesson.props.header,\n        auditorium: lesson.props.footer,\n        lesson_type: LabelsInt[lesson.props.sourceIdx]\n    }))\n}\n\nconst changeWeekType = (week_type: string) => {\n    return week_type === \"Чc\" ? \"numerator\" : \"denominator\";\n}\n\nconst postWeekData = (week: object, showLabel: (err: any) => void) => {\n    makePost(Urls.timetable.post(), week).then((resp) => {\n        console.log(resp)\n        if (resp.status !== 201) {\n            showLabel({content: \"Не удалось сохранить изменения!\", success: false})\n        } else {\n            showLabel({content: \"Успех!\", success: true})\n        }\n    }).catch(() => {\n        showLabel({content: \"Не удалось сохранить изменения!\", success: false})\n    })\n}\n\nexport const saveTimetable = (Lists: object, deleted: { lessons: Array<string> }, panelData: { group: number; semester: number; week: number; weekType: string },\n                              showLabel: any) => {\n    const week = {\n        group: `IU10-${panelData.semester}${panelData.group}`,\n        week_type: changeWeekType(panelData.weekType),\n        week_number: panelData.weekType === \"Чс\" ? 1 : 2,\n        days: <Array<object>>[]\n    }\n    const idx = Object.keys(Lists)\n    idx.forEach((i) => {\n        week.days.push(\n            {\n                day_order: parseInt(i) + 1,\n                lessons: getDayDataFromList(Lists[i])\n            }\n        )\n    });\n    showLabel({content: \"\", success: false});\n\n    console.log(week)\n\n\n    makeDelete(Urls.timetable.delete(), {lessons_ids: deleted.lessons}).then((response) => {\n        if (response.status === 200) {\n            postWeekData(week, showLabel)\n        } else {\n            showLabel({content: \"Ошибка при удалении записей!\", success: false})\n        }\n    }).catch((err) => {\n        if (err.response && err.response.status === 403) {\n            showLabel({content: \"Недостаточно прав для изменения!\", success: false})\n        } else {\n            showLabel({content: \"Ошибка при удалении записей!\", success: false})\n        }\n    })\n}\n"]},"metadata":{},"sourceType":"module"}