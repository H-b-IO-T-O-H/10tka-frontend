{"ast":null,"code":"var _jsxFileName = \"/home/vlad/10tka/10tka-frontend/src/pages/PostCreate/createPost.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { MDBBtn, MDBInput } from \"mdbreact\";\nimport { Editor } from \"@tinymce/tinymce-react\";\nimport PulseCheckBox from \"@components/PulseCheckBox\";\nimport { TAG_EDUCATIONAL, TAG_GENERAL, TAG_IMPORTANT } from \"@config/config\";\nimport { useHistory } from \"react-router-dom\";\nimport { getTinymce } from \"@tinymce/tinymce-react/lib/es2015/main/ts/TinyMCE\";\nimport Admin from \"@media/admin.jpg\";\nimport \"./createPost.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CreatePost = () => {\n  _s();\n\n  const [postInfo, changePostInfo] = React.useState({\n    title: \"\",\n    postImgUrl: Admin,\n    tag: \"\",\n    allowComments: false,\n    content: \"\",\n    buttonText: \"Предпросмотр\"\n  });\n  const [tagContent, changeTagContent] = React.useState(\"\");\n  const [tag, changeTag] = React.useState();\n  const [postImgInput, changePostImgInput] = React.useState();\n  const [isTextChanged, changeTextFlag] = React.useState(false);\n  const history = useHistory();\n  React.useEffect(() => {\n    changeTag(document.getElementById(\"post-tag\"));\n    changePostImgInput(document.getElementById(\"post-img\"));\n  }, []);\n  const handleTitleChange = React.useCallback(e => {\n    const oldInfo = postInfo;\n    oldInfo.title = e.target.value;\n    changePostInfo(oldInfo);\n  }, [postInfo]);\n  const handleEditorChange = React.useCallback((content, editor) => {\n    const oldInfo = { ...postInfo\n    };\n    oldInfo.content = content;\n    oldInfo.buttonText = \"Предпросмотр\";\n    changeTextFlag(false);\n    changePostInfo(oldInfo);\n  }, [postInfo]);\n  const handleButtonChange = React.useCallback(() => {\n    if (!isTextChanged) {\n      var _getTinymce;\n\n      (_getTinymce = getTinymce()) === null || _getTinymce === void 0 ? void 0 : _getTinymce.activeEditor.execCommand(\"mcePreview\"); //tinymce.get(\"post-create-editor\").execCommand(\"mcePreview\");\n    } else {\n      console.log(postInfo); //history.push(\"/posts\");\n    }\n\n    changeTextFlag(true);\n    const oldInfo = { ...postInfo\n    };\n    oldInfo.buttonText = \"Опубликовать\";\n    changePostInfo(oldInfo); //TEMP.posts.push(Parser(postInfo.content) as JSX.Element);\n    //console.log(TEMP);\n    //this.setState({buttonText: \"Опубликовать\"});\n  }, [isTextChanged, postInfo]);\n  const handleSelectChange = React.useCallback(e => {\n    if (!tag) {\n      return;\n    }\n\n    switch (e.target.value) {\n      case \"1\":\n        tag.style.color = \"#34a8bb\";\n        break;\n\n      case \"2\":\n        tag.style.color = \"#e86262\";\n        break;\n\n      default:\n        tag.style.color = \"#59b759\";\n    }\n  }, [tag]);\n\n  const handleImgChange = () => {\n    const oldPost = { ...postInfo\n    };\n\n    if (postImgInput && postImgInput.files && postImgInput.files[0]) {\n      oldPost.postImgUrl = URL.createObjectURL(postImgInput.files[0]);\n      changePostInfo(oldPost);\n      console.log(postInfo);\n    }\n  };\n\n  const handleCheckBoxChange = React.useCallback(isChecked => {\n    const oldInfo = { ...postInfo\n    };\n    oldInfo.allowComments = isChecked;\n    changePostInfo(oldInfo);\n  }, [postInfo]);\n  const filePickerCb = React.useCallback((callback, value, meta) => {\n    if (meta.filetype === 'image') {\n      let input = document.createElement(\"input\");\n      let file;\n      input.setAttribute(\"type\", \"file\");\n      input.setAttribute(\"accept\", \"image/*\");\n\n      input.onchange = () => {\n        if (input.files) {\n          file = input.files[0];\n        }\n\n        const reader = new FileReader();\n\n        reader.onload = e => {\n          var _e$target;\n\n          callback((_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result, {\n            alt: file.name\n          });\n        };\n\n        reader.readAsDataURL(file);\n      };\n\n      input.click();\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"post-card container-fluid d-flex h-100 justify-content-center align-items-center col-xl-10\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"post-create-card container\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"h5 text-center mb-4\",\n          children: \"\\u0421\\u043E\\u0437\\u0434\\u043D\\u0438\\u0435 \\u043F\\u043E\\u0441\\u0442\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex flex-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-2 d-flex flex-column flex-nowrap align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              id: \"blah\",\n              src: postInfo.postImgUrl,\n              alt: \"img not loaded\",\n              className: \"post-img\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"post-img\",\n              type: \"file\",\n              id: \"post-img\",\n              accept: \"image/*\",\n              onChange: handleImgChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-upload-img\",\n              type: \"button\",\n              onClick: () => {\n                postImgInput === null || postImgInput === void 0 ? void 0 : postImgInput.click();\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"btn-title\",\n                children: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-10\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grey-text\",\n              children: [/*#__PURE__*/_jsxDEV(MDBInput, {\n                label: \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\",\n                icon: \"heading\",\n                group: true,\n                type: \"text\",\n                onChange: handleTitleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex flex-row\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  id: \"post-tag\",\n                  className: \"fa fa-tag fa-lg position-absolute\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"post-tag\",\n                  defaultValue: \"0\",\n                  onChange: handleSelectChange,\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"0\",\n                    hidden: true,\n                    disabled: true,\n                    children: \"\\u0422\\u042D\\u0413\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 149,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"1\",\n                    children: TAG_GENERAL\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"2\",\n                    children: TAG_IMPORTANT\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"3\",\n                    children: TAG_EDUCATIONAL\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 152,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex flex-row\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fa fa-pencil-alt fa-lg position-absolute\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"editor-with-tag\",\n                  children: /*#__PURE__*/_jsxDEV(Editor, {\n                    id: \"post-create-editor\",\n                    apiKey: \"i2ukwtg8ixnvv92anoj0cspm5r696rucv5oxdaten85488x4\",\n                    init: {\n                      language: \"ru\",\n                      min_height: 350,\n                      height: 500,\n                      max_height: 750,\n                      plugins: [\"advlist autolink lists link image charmap print preview anchor\", \"searchreplace visualblocks code fullscreen \", \"insertdatetime media table paste code help wordcount emoticons hr imagetools\" //TODO: check imagetools proxy\n                      ],\n                      toolbar: \"undo redo | image hr| formatselect | bold italic forecolor backcolor | \\\n                                                    alignleft aligncenter alignright alignjustify | \\\n                                                    numlist bullist outdent indent | removeformat\",\n                      style_formats_merge: true,\n                      style_formats: [{\n                        title: 'Image Top',\n                        selector: 'img',\n                        styles: {\n                          'vertical-align': 'top'\n                        }\n                      }, {\n                        title: 'Image Middle',\n                        selector: 'img',\n                        styles: {\n                          'vertical-align': 'middle'\n                        }\n                      }, {\n                        title: 'Image Bottom',\n                        selector: 'img',\n                        styles: {\n                          'vertical-align': 'bottom'\n                        }\n                      }],\n                      insertdatetime_formats: ['%H:%M:%S', '%d-%m-%Y', '%I:%M:%S %p'],\n                      image_advtab: true,\n                      fullscreen_native: true,\n                      automatic_uploads: true,\n                      image_description: false,\n                      file_picker_types: \"image\",\n                      paste_webkit_styles: 'color font-size',\n                      paste_retain_style_properties: 'color font-size',\n                      paste_data_images: false,\n                      paste_as_text: false,\n                      file_picker_callback: filePickerCb,\n                      content_style: \"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }\"\n                    },\n                    value: postInfo.content,\n                    onEditorChange: handleEditorChange\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3\",\n                children: /*#__PURE__*/_jsxDEV(PulseCheckBox, {\n                  description: \"\\u0420\\u0430\\u0437\\u0440\\u0435\\u0448\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0438\",\n                  isChecked: handleCheckBoxChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: /*#__PURE__*/_jsxDEV(MDBBtn, {\n                outline: true,\n                color: \"cyan\",\n                onClick: handleButtonChange,\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: postInfo.buttonText\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 126,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CreatePost, \"ELk0Mh9MMDL3pzZB4K7VT6tX4DY=\", false, function () {\n  return [useHistory];\n});\n\n_c = CreatePost;\nexport default CreatePost;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePost\");","map":{"version":3,"sources":["/home/vlad/10tka/10tka-frontend/src/pages/PostCreate/createPost.tsx"],"names":["React","MDBBtn","MDBInput","Editor","PulseCheckBox","TAG_EDUCATIONAL","TAG_GENERAL","TAG_IMPORTANT","useHistory","getTinymce","Admin","CreatePost","postInfo","changePostInfo","useState","title","postImgUrl","tag","allowComments","content","buttonText","tagContent","changeTagContent","changeTag","postImgInput","changePostImgInput","isTextChanged","changeTextFlag","history","useEffect","document","getElementById","handleTitleChange","useCallback","e","oldInfo","target","value","handleEditorChange","editor","handleButtonChange","activeEditor","execCommand","console","log","handleSelectChange","style","color","handleImgChange","oldPost","files","URL","createObjectURL","handleCheckBoxChange","isChecked","filePickerCb","callback","meta","filetype","input","createElement","file","setAttribute","onchange","reader","FileReader","onload","result","alt","name","readAsDataURL","click","language","min_height","height","max_height","plugins","toolbar","style_formats_merge","style_formats","selector","styles","insertdatetime_formats","image_advtab","fullscreen_native","automatic_uploads","image_description","file_picker_types","paste_webkit_styles","paste_retain_style_properties","paste_data_images","paste_as_text","file_picker_callback","content_style"],"mappings":"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","sourcesContent":["import React, {FormEvent} from \"react\";\nimport {MDBBtn, MDBInput} from \"mdbreact\";\nimport {Editor} from \"@tinymce/tinymce-react\";\nimport PulseCheckBox from \"@components/PulseCheckBox\";\nimport {TAG_EDUCATIONAL, TAG_GENERAL, TAG_IMPORTANT} from \"@config/config\";\nimport {useHistory} from \"react-router-dom\";\nimport {getTinymce} from \"@tinymce/tinymce-react/lib/es2015/main/ts/TinyMCE\";\nimport Admin from \"@media/admin.jpg\"\n\nimport \"./createPost.scss\";\n\ntype PostInfo = {\n    title: string,\n    postImgUrl: string,\n    tag: string,\n    allowComments: boolean,\n    content: string,\n    buttonText: string\n}\n\nconst CreatePost = () => {\n    const [postInfo, changePostInfo] = React.useState<PostInfo>({\n        title: \"\",\n        postImgUrl: Admin,\n        tag: \"\",\n        allowComments: false,\n        content: \"\",\n        buttonText: \"Предпросмотр\"\n    })\n    const [tagContent, changeTagContent] = React.useState(\"\")\n    const [tag, changeTag] = React.useState<HTMLElement | null>()\n    const [postImgInput, changePostImgInput] = React.useState<HTMLInputElement | null>();\n    const [isTextChanged, changeTextFlag] = React.useState(false);\n    const history = useHistory();\n\n    React.useEffect(() => {\n        changeTag(document.getElementById(\"post-tag\"));\n        changePostImgInput(document.getElementById(\"post-img\") as HTMLInputElement);\n    }, []);\n\n    const handleTitleChange = React.useCallback((e: FormEvent<HTMLInputElement>) => {\n        const oldInfo = postInfo;\n        oldInfo.title = (e.target as HTMLInputElement).value;\n        changePostInfo(oldInfo);\n    }, [postInfo]);\n\n    const handleEditorChange = React.useCallback((content: string, editor: any) => {\n        const oldInfo = {...postInfo};\n        oldInfo.content = content;\n        oldInfo.buttonText = \"Предпросмотр\";\n        changeTextFlag(false);\n        changePostInfo(oldInfo);\n    }, [postInfo]);\n\n    const handleButtonChange = React.useCallback(() => {\n        if (!isTextChanged) {\n            getTinymce()?.activeEditor.execCommand(\"mcePreview\");\n            //tinymce.get(\"post-create-editor\").execCommand(\"mcePreview\");\n        } else {\n            console.log(postInfo);\n            //history.push(\"/posts\");\n        }\n        changeTextFlag(true);\n        const oldInfo = {...postInfo};\n        oldInfo.buttonText = \"Опубликовать\";\n        changePostInfo(oldInfo);\n        //TEMP.posts.push(Parser(postInfo.content) as JSX.Element);\n        //console.log(TEMP);\n        //this.setState({buttonText: \"Опубликовать\"});\n    }, [isTextChanged, postInfo]);\n\n    const handleSelectChange = React.useCallback((e: React.ChangeEvent<HTMLSelectElement>) => {\n        if (!tag) {\n            return;\n        }\n        switch (e.target.value) {\n            case \"1\":\n                tag.style.color = \"#34a8bb\";\n                break;\n            case \"2\":\n                tag.style.color = \"#e86262\";\n                break;\n            default:\n                tag.style.color = \"#59b759\";\n        }\n    }, [tag]);\n\n    const handleImgChange = () => {\n        const oldPost = {...postInfo};\n        if (postImgInput && postImgInput.files && postImgInput.files[0]) {\n            oldPost.postImgUrl = URL.createObjectURL(postImgInput.files[0]);\n            changePostInfo(oldPost);\n            console.log(postInfo)\n        }\n    };\n\n    const handleCheckBoxChange = React.useCallback((isChecked: boolean) => {\n        const oldInfo = {...postInfo};\n        oldInfo.allowComments = isChecked;\n        changePostInfo(oldInfo);\n    }, [postInfo])\n\n    const filePickerCb = React.useCallback((callback: Function, value: any, meta: Record<string, any>) => {\n        if (meta.filetype === 'image') {\n            let input = document.createElement(\"input\");\n            let file: File;\n            input.setAttribute(\"type\", \"file\");\n            input.setAttribute(\"accept\", \"image/*\");\n            input.onchange = () => {\n                if (input.files) {\n                    file = input.files[0];\n                }\n                const reader = new FileReader();\n                reader.onload = (e) => {\n                    callback(e.target?.result, {\n                        alt: file.name\n                    });\n                }\n                reader.readAsDataURL(file);\n            };\n            input.click();\n        }\n    }, []);\n\n    return (\n        <div>\n            <div\n                className=\"post-card container-fluid d-flex h-100 justify-content-center align-items-center col-xl-10\">\n                <form className=\"post-create-card container\">\n                    <p className=\"h5 text-center mb-4\">Создние поста</p>\n                    <div className=\"d-flex flex-row\">\n                        <div className=\"col-2 d-flex flex-column flex-nowrap align-items-center\">\n                            <img id=\"blah\" src={postInfo.postImgUrl} alt=\"img not loaded\" className=\"post-img\"/>\n                            <input className=\"post-img\" type=\"file\" id=\"post-img\" accept=\"image/*\"\n                                   onChange={handleImgChange}/>\n                            <button className=\"btn-upload-img\" type=\"button\" onClick={() => {\n                                postImgInput?.click()\n                            }}>\n                                <span className=\"btn-title\">...</span>\n                            </button>\n                        </div>\n                        <div className=\"col-10\">\n                            <div className=\"grey-text\">\n                                <MDBInput label=\"Заголовок\" icon=\"heading\" group type=\"text\"\n                                          onChange={handleTitleChange}/>\n                                <div className=\"d-flex flex-row\">\n                                    <i id=\"post-tag\" className=\"fa fa-tag fa-lg position-absolute\"/>\n                                    <select className=\"post-tag\" defaultValue=\"0\" onChange={handleSelectChange}>\n                                        <option value=\"0\" hidden disabled>ТЭГ</option>\n                                        <option value=\"1\">{TAG_GENERAL}</option>\n                                        <option value=\"2\">{TAG_IMPORTANT}</option>\n                                        <option value=\"3\">{TAG_EDUCATIONAL}</option>\n                                    </select>\n                                </div>\n                                <div className=\"d-flex flex-row\">\n                                    <i className=\"fa fa-pencil-alt fa-lg position-absolute\"/>\n                                    <div className=\"editor-with-tag\">\n                                        <Editor\n                                            id=\"post-create-editor\"\n                                            apiKey=\"i2ukwtg8ixnvv92anoj0cspm5r696rucv5oxdaten85488x4\"\n                                            init={{\n                                                language: \"ru\",\n                                                min_height: 350,\n                                                height: 500,\n                                                max_height: 750,\n                                                plugins: [\n                                                    \"advlist autolink lists link image charmap print preview anchor\",\n                                                    \"searchreplace visualblocks code fullscreen \",\n                                                    \"insertdatetime media table paste code help wordcount emoticons hr imagetools\", //TODO: check imagetools proxy\n                                                ],\n                                                toolbar:\n                                                    \"undo redo | image hr| formatselect | bold italic forecolor backcolor | \\\n                                                    alignleft aligncenter alignright alignjustify | \\\n                                                    numlist bullist outdent indent | removeformat\",\n                                                style_formats_merge: true,\n                                                style_formats: [\n                                                    {\n                                                        title: 'Image Top', selector: 'img', styles: {\n                                                            'vertical-align': 'top'\n                                                        }\n                                                    },\n                                                    {\n                                                        title: 'Image Middle', selector: 'img', styles: {\n                                                            'vertical-align': 'middle'\n                                                        }\n                                                    },\n                                                    {\n                                                        title: 'Image Bottom', selector: 'img', styles: {\n                                                            'vertical-align': 'bottom'\n                                                        }\n                                                    },\n                                                ],\n                                                insertdatetime_formats: ['%H:%M:%S', '%d-%m-%Y', '%I:%M:%S %p'],\n                                                image_advtab: true,\n                                                fullscreen_native: true,\n                                                automatic_uploads: true,\n                                                image_description: false,\n                                                file_picker_types: \"image\",\n                                                paste_webkit_styles: 'color font-size',\n                                                paste_retain_style_properties: 'color font-size',\n                                                paste_data_images: false,\n                                                paste_as_text: false,\n                                                file_picker_callback: filePickerCb,\n                                                content_style: \"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }\"\n                                            }}\n                                            value={postInfo.content}\n                                            onEditorChange={handleEditorChange}\n                                        />\n                                    </div>\n                                </div>\n                                <div className=\"mt-3\">\n                                    <PulseCheckBox description=\"Разрешить комментарии\" isChecked={handleCheckBoxChange}/>\n                                </div>\n                            </div>\n                            <div className=\"text-center\">\n                                <MDBBtn outline color=\"cyan\" onClick={handleButtonChange}>\n                                    <span>{postInfo.buttonText}</span>\n                                </MDBBtn>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n    )\n}\n\nexport default CreatePost;"]},"metadata":{},"sourceType":"module"}