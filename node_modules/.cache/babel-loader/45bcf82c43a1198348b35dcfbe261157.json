{"ast":null,"code":"var _jsxFileName = \"/home/vlad/10tka/10tka-frontend/src/pages/Authorization/Authorization.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { DOMAIN, LOGOUT, Urls } from \"@config/urls\";\nimport { DEFAULT_SESSION_TIME, EMPTY_EMAIL_FIELD, EMPTY_PASSWORD_FIELD, ERROR_EMAIL_FIELD, ERROR_PASSWORD_FIELD, PASSWORD_MAX_LENGTH, PASSWORD_MIN_LENGTH } from \"./config\";\nimport \"./Authorization.scss\";\nimport AuthError from \"@components/AuthError\";\nimport { makePost } from \"@utils/network\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Logout = history => {\n  makePost(`${DOMAIN}${LOGOUT}`, null).then(r => {}).catch(e => {});\n  localStorage.clear();\n  history.replace(Urls.auth);\n};\n_c = Logout;\nexport const DefaultCheckLogin = () => {\n  const lastAuthTime = parseInt(localStorage.getItem(\"loginTime\"));\n  return lastAuthTime != null && Date.now() - lastAuthTime < DEFAULT_SESSION_TIME;\n};\n_c2 = DefaultCheckLogin;\n\nconst Auth = () => {\n  _s();\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [emailDirty, setEmailDirty] = useState(false);\n  const [passwordDirty, setPasswordDirty] = useState(false);\n  const [emailError, setEmailError] = useState(EMPTY_EMAIL_FIELD);\n  const [passwordError, setPasswordError] = useState(EMPTY_PASSWORD_FIELD);\n  const [formValid, setFormValid] = useState(false);\n  const [userError, setUserError] = useState('');\n  const [checkBox, setCheckBox] = useState(false);\n  const history = useHistory();\n  const CheckBoxHandler = React.useCallback(e => {\n    setCheckBox(e.target.checked);\n  }, []);\n  const HandleSubmit = React.useCallback(e => {\n    e.preventDefault(); //addUsers();\n\n    localStorage.setItem(\"loginTime\", Date.now().toString());\n    localStorage.setItem(\"user_role\", 'admin');\n    const userGroup = \"IU10-83\";\n    history.push(Urls.feed.slugRoot); // makePost(`${DOMAIN}${LOGIN}`, {\n    //     email: email,\n    //     password: password,\n    //     checkbox: checkBox\n    // }).then((response) => {\n    //     localStorage.setItem(\"loginTime\", Date.now().toString());\n    //     const userGroup = response.data.user.group;\n    //     //console.log(\"User = \", response.data.user)\n    //     if (userGroup !== \"\") {\n    //         localStorage.setItem(\"user_group\", response.data.user.group)\n    //     }\n    //     localStorage.setItem(\"user_role\", response.data.user.role)\n    //     history.push(Urls.timetable.slugRoot);\n    // }).catch((error) => {\n    //     if (error.response) {\n    //         if (error.response.status === 404) {\n    //             setUserError(ERROR_AUTHORIZATION);\n    //         } else {\n    //             setUserError(ERROR_SERVER);\n    //         }\n    //     } else {\n    //         setUserError(SERVER_UNAVAILABLE);\n    //     }\n    //     return;\n    // });\n  }, [email, password, checkBox, history]);\n  useEffect(() => {\n    if (emailError || passwordError) {\n      setFormValid(false);\n    } else {\n      setFormValid(true);\n    }\n  }, [emailError, passwordError]);\n  const EmailHandler = React.useCallback(e => {\n    const emailNew = e.target.value;\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n    if (!re.test(String(emailNew).toLowerCase())) {\n      setEmailError(ERROR_EMAIL_FIELD);\n    } else setEmailError('');\n\n    setEmail(emailNew);\n  }, []);\n  const PasswordHandler = React.useCallback(e => {\n    const passwdNew = e.target.value;\n\n    if (passwdNew.length < PASSWORD_MIN_LENGTH || passwdNew.length > PASSWORD_MAX_LENGTH) {\n      setPasswordError(ERROR_PASSWORD_FIELD);\n\n      if (!passwdNew.length) {\n        setPasswordError(EMPTY_PASSWORD_FIELD);\n      }\n    } else setPasswordError('');\n\n    setPassword(passwdNew);\n  }, []);\n  const BlurHandler = React.useCallback(e => {\n    if (e.target.name === \"email\") {\n      setEmailDirty(true);\n    } else {\n      setPasswordDirty(true);\n    }\n\n    setUserError(\"\");\n  }, []);\n  return (\n    /*#__PURE__*/\n    // <div className=\"Auth h-100 d-flex justify-content-center align-items-center text-center\">\n    //     <form className=\"Auth__form\">\n    //         <div className=\"form-group\">\n    //             <div>Email</div>\n    //             {(emailDirty && emailError) && <AuthError msg={emailError}/>}\n    //             <input onChange={EmailHandler} value={email} name=\"email\" onBlur={BlurHandler}\n    //                    type=\"text\" className=\"form-control\"\n    //                    placeholder=\"Введите email\"/>\n    //         </div>\n    //         <div className=\"form-group\">\n    //             <div>Пароль</div>\n    //             {(passwordDirty && passwordError) && <AuthError msg={passwordError}/>}\n    //             <input onChange={PasswordHandler} value={password} name=\"password\"\n    //                    onBlur={BlurHandler} type=\"password\" className=\"form-control Auth__pass\"\n    //                    placeholder=\"Введите пароль\"/>\n    //         </div>\n    //         <div className=\"form-check\">\n    //             <input onChange={CheckBoxHandler} type=\"checkbox\" className=\"form-check-input\"/>\n    //             <div className=\"form-check-div\">Запомнить</div>\n    //         </div>\n    //         {(userError) && <AuthError msg={userError}/>}\n    //         <button disabled={!formValid} onClick={HandleSubmit} type=\"submit\" className=\"btn Auth__btn mt-2\">Войти\n    //         </button>\n    //     </form>\n    // </div>\n    _jsxDEV(\"div\", {\n      className: \"container-fluid d-flex h-100 justify-content-center align-items-center text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row bg-white shadow-sm m-1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col border rounded p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: \"Email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 29\n              }, this), emailDirty && emailError && /*#__PURE__*/_jsxDEV(AuthError, {\n                msg: emailError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 60\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onBlur: BlurHandler,\n                onChange: EmailHandler,\n                value: email,\n                type: \"text\",\n                className: \"form-control\",\n                name: \"email\",\n                placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 email...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                id: \"emailHelp\",\n                className: \"form-text text-muted\",\n                children: \"\\u041C\\u044B \\u043D\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0435\\u043C \\u0432\\u0430\\u0448\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0441\\u0442\\u043E\\u0440\\u043E\\u043D\\u043D\\u0438\\u043C \\u0438\\u0441\\u0442\\u043E\\u0447\\u043D\\u0438\\u043A\\u0430\\u043C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 29\n              }, this), passwordDirty && passwordError && /*#__PURE__*/_jsxDEV(AuthError, {\n                msg: passwordError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 66\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                onBlur: BlurHandler,\n                onChange: PasswordHandler,\n                value: password,\n                className: \"form-control\",\n                type: \"password\",\n                placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex flex-row justify-content-center align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"mr-1\",\n                onChange: CheckBoxHandler,\n                type: \"checkbox\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: \"\\u0417\\u0430\\u043F\\u043E\\u043C\\u043D\\u0438\\u0442\\u044C \\u043C\\u0435\\u043D\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-0\",\n              children: [\" \", userError && /*#__PURE__*/_jsxDEV(AuthError, {\n                msg: userError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 63\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-3\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                disabled: !formValid,\n                onClick: HandleSubmit,\n                type: \"submit\",\n                className: \"btn Auth__btn mt-2\",\n                children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }, this)\n  );\n};\n\n_s(Auth, \"0fuip9QGy1LT5cL4xBug0zjIthE=\", false, function () {\n  return [useHistory];\n});\n\n_c3 = Auth;\nexport default Auth;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Logout\");\n$RefreshReg$(_c2, \"DefaultCheckLogin\");\n$RefreshReg$(_c3, \"Auth\");","map":{"version":3,"sources":["/home/vlad/10tka/10tka-frontend/src/pages/Authorization/Authorization.tsx"],"names":["React","useEffect","useState","useHistory","DOMAIN","LOGOUT","Urls","DEFAULT_SESSION_TIME","EMPTY_EMAIL_FIELD","EMPTY_PASSWORD_FIELD","ERROR_EMAIL_FIELD","ERROR_PASSWORD_FIELD","PASSWORD_MAX_LENGTH","PASSWORD_MIN_LENGTH","AuthError","makePost","Logout","history","then","r","catch","e","localStorage","clear","replace","auth","DefaultCheckLogin","lastAuthTime","parseInt","getItem","Date","now","Auth","email","setEmail","password","setPassword","emailDirty","setEmailDirty","passwordDirty","setPasswordDirty","emailError","setEmailError","passwordError","setPasswordError","formValid","setFormValid","userError","setUserError","checkBox","setCheckBox","CheckBoxHandler","useCallback","target","checked","HandleSubmit","preventDefault","setItem","toString","userGroup","push","feed","slugRoot","EmailHandler","emailNew","value","re","test","String","toLowerCase","PasswordHandler","passwdNew","length","BlurHandler","name"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {useHistory} from \"react-router-dom\"\n\nimport {DOMAIN, LOGIN, LOGOUT, Urls} from \"@config/urls\";\n\nimport {\n    DEFAULT_SESSION_TIME,\n    EMPTY_EMAIL_FIELD,\n    EMPTY_PASSWORD_FIELD,\n    ERROR_AUTHORIZATION,\n    ERROR_EMAIL_FIELD,\n    ERROR_PASSWORD_FIELD,\n    ERROR_SERVER,\n    PASSWORD_MAX_LENGTH,\n    PASSWORD_MIN_LENGTH,\n    SERVER_UNAVAILABLE\n} from \"./config\";\nimport \"./Authorization.scss\"\nimport AuthError from \"@components/AuthError\";\nimport {makePost} from \"@utils/network\";\nimport {addUsers} from \"@utils/addUsers\";\n\nexport const Logout = (history: any) => {\n    makePost(`${DOMAIN}${LOGOUT}`, null).then((r) => {\n    }).catch((e) => {\n    })\n    localStorage.clear()\n    history.replace(Urls.auth);\n}\n\nexport const DefaultCheckLogin = () => {\n    const lastAuthTime = parseInt(localStorage.getItem(\"loginTime\") as string);\n    return lastAuthTime != null && Date.now() - lastAuthTime < DEFAULT_SESSION_TIME;\n}\n\nconst Auth = () => {\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [emailDirty, setEmailDirty] = useState(false);\n    const [passwordDirty, setPasswordDirty] = useState(false);\n    const [emailError, setEmailError] = useState(EMPTY_EMAIL_FIELD);\n    const [passwordError, setPasswordError] = useState(EMPTY_PASSWORD_FIELD);\n    const [formValid, setFormValid] = useState(false);\n    const [userError, setUserError] = useState('');\n    const [checkBox, setCheckBox] = useState(false);\n    const history = useHistory();\n\n    const CheckBoxHandler = React.useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n        setCheckBox(e.target.checked);\n    }, []);\n\n    const HandleSubmit = React.useCallback((e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n        e.preventDefault();\n\n        //addUsers();\n\n        localStorage.setItem(\"loginTime\", Date.now().toString());\n        localStorage.setItem(\"user_role\", 'admin')\n        const userGroup = \"IU10-83\";\n        history.push(Urls.feed.slugRoot);\n\n        // makePost(`${DOMAIN}${LOGIN}`, {\n        //     email: email,\n        //     password: password,\n        //     checkbox: checkBox\n        // }).then((response) => {\n        //     localStorage.setItem(\"loginTime\", Date.now().toString());\n        //     const userGroup = response.data.user.group;\n        //     //console.log(\"User = \", response.data.user)\n        //     if (userGroup !== \"\") {\n        //         localStorage.setItem(\"user_group\", response.data.user.group)\n        //     }\n        //     localStorage.setItem(\"user_role\", response.data.user.role)\n        //     history.push(Urls.timetable.slugRoot);\n        // }).catch((error) => {\n        //     if (error.response) {\n        //         if (error.response.status === 404) {\n        //             setUserError(ERROR_AUTHORIZATION);\n        //         } else {\n        //             setUserError(ERROR_SERVER);\n        //         }\n        //     } else {\n        //         setUserError(SERVER_UNAVAILABLE);\n        //     }\n        //     return;\n        // });\n\n    }, [email, password, checkBox, history]);\n\n    useEffect(() => {\n        if (emailError || passwordError) {\n            setFormValid(false);\n        } else {\n            setFormValid(true);\n        }\n    }, [emailError, passwordError]);\n\n    const EmailHandler = React.useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n        const emailNew = e.target.value;\n        const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        if (!re.test(String(emailNew).toLowerCase())) {\n            setEmailError(ERROR_EMAIL_FIELD)\n        } else setEmailError('');\n        setEmail(emailNew);\n    }, []);\n\n    const PasswordHandler = React.useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n        const passwdNew = e.target.value;\n        if (passwdNew.length < PASSWORD_MIN_LENGTH || passwdNew.length > PASSWORD_MAX_LENGTH) {\n            setPasswordError(ERROR_PASSWORD_FIELD);\n            if (!passwdNew.length) {\n                setPasswordError(EMPTY_PASSWORD_FIELD);\n            }\n        } else setPasswordError('');\n        setPassword(passwdNew);\n    }, []);\n\n    const BlurHandler = React.useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n        if (e.target.name === \"email\") {\n            setEmailDirty(true);\n        } else {\n            setPasswordDirty(true);\n        }\n        setUserError(\"\");\n    }, []);\n\n    return (\n        // <div className=\"Auth h-100 d-flex justify-content-center align-items-center text-center\">\n        //     <form className=\"Auth__form\">\n        //         <div className=\"form-group\">\n        //             <div>Email</div>\n        //             {(emailDirty && emailError) && <AuthError msg={emailError}/>}\n        //             <input onChange={EmailHandler} value={email} name=\"email\" onBlur={BlurHandler}\n        //                    type=\"text\" className=\"form-control\"\n        //                    placeholder=\"Введите email\"/>\n        //         </div>\n        //         <div className=\"form-group\">\n        //             <div>Пароль</div>\n        //             {(passwordDirty && passwordError) && <AuthError msg={passwordError}/>}\n        //             <input onChange={PasswordHandler} value={password} name=\"password\"\n        //                    onBlur={BlurHandler} type=\"password\" className=\"form-control Auth__pass\"\n        //                    placeholder=\"Введите пароль\"/>\n        //         </div>\n        //         <div className=\"form-check\">\n        //             <input onChange={CheckBoxHandler} type=\"checkbox\" className=\"form-check-input\"/>\n        //             <div className=\"form-check-div\">Запомнить</div>\n        //         </div>\n        //         {(userError) && <AuthError msg={userError}/>}\n        //         <button disabled={!formValid} onClick={HandleSubmit} type=\"submit\" className=\"btn Auth__btn mt-2\">Войти\n        //         </button>\n        //     </form>\n        // </div>\n        <div className=\"container-fluid d-flex h-100 justify-content-center align-items-center text-center\">\n            <div className=\"row bg-white shadow-sm m-1\">\n                <div className=\"col border rounded p-4\">\n                    <form>\n                        <div className=\"form-group\">\n                            <div>Email</div>\n                            {(emailDirty && emailError) && <AuthError msg={emailError}/>}\n                            <input onBlur={BlurHandler} onChange={EmailHandler} value={email}\n                                   type=\"text\" className=\"form-control\" name=\"email\" placeholder=\"Введите email...\"/>\n                            <small id=\"emailHelp\" className=\"form-text text-muted\">Мы не передаем ваши данные\n                                сторонним источникам</small>\n                        </div>\n                        <div className=\"form-group\">\n                            <div>Пароль</div>\n                            {(passwordDirty && passwordError) && <AuthError msg={passwordError}/>}\n                            <input onBlur={BlurHandler} onChange={PasswordHandler} value={password}\n                                   className=\"form-control\" type=\"password\"\n                                   placeholder=\"Введите пароль...\"/>\n                        </div>\n                        <div className=\"d-flex flex-row justify-content-center align-items-center\">\n                            <input className=\"mr-1\" onChange={CheckBoxHandler} type=\"checkbox\"/>\n                            <div>Запомнить меня</div>\n                        </div>\n                        <div className=\"p-0\"> {(userError) && <AuthError msg={userError}/>}</div>\n                        <div className=\"p-3\">\n                            <button disabled={!formValid} onClick={HandleSubmit} type=\"submit\"\n                                    className=\"btn Auth__btn mt-2\">Войти\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}